# Gemini 3 Flash - Baseline Analysis
**Date:** 2026-02-26  
**Model:** google/gemini-3-flash-preview  
**Run IDs (with_guidelines):** jn7062chca1fbmt288bmfcx79d81w8cb, jn741xc0708fvw5fw2e1b37rvn81xq5m, jn7fgntkq2361jyv9dm924012s81x8gp  
**Run IDs (no_guidelines):** jn7dkj3wwbkw5fxn54sqw20bk981xx5g, jn7fp5wcgbywv1t4x4x38rs1eh81wnfb, jn72wwr10ff2ja0vfvmsz1d53h81x33g  

---

## Overall Performance

| Experiment | Run 1 | Run 2 | Run 3 | Average |
|---|---|---|---|---|
| with_guidelines | 59/66 (89.4%) | 60/66 (90.9%) | 61/66 (92.4%) | **91.0%** |
| no_guidelines | 59/66 (89.4%) | 59/66 (89.4%) | 58/66 (87.9%) | **88.9%** |

**Guidelines benefit: +2.1 pp**

---

## Failure Summary (with_guidelines)

| Step type | Count |
|---|---|
| tests | 5 |
| deploy | 3 |
| eslint | 1 |

---

## Failure Stability Across Runs (with_guidelines)

| Eval | Run1 | Run2 | Run3 | Freq | Classification | Step |
|---|---|---|---|---|---|---|
| 000-fundamentals/009-returns_validator | ❌ | ❌ | ❌ | 3/3 | KNOWN_GAP | deploy |
| 002-queries/018-pagination_returns_validator | ❌ | ❌ | ❌ | 3/3 | KNOWN_GAP | tests |
| 004-actions/007-http_action_routing | ❌ | ❌ | ❌ | 3/3 | MODEL_FAULT | tests |
| 006-clients/001-use_mutation | ❌ | ❌ | ❌ | 3/3 | MODEL_FAULT | eslint |
| 003-mutations/006-no_storage | ❌ | ❌ | ✅ | 2/3 | MODEL_FAULT | deploy |
| 005-idioms/002-batch_queries | ❌ | ✅ | ❌ | 2/3 | MODEL_FAULT | tests |
| 004-actions/005-storage_http_action | ❌ | ✅ | ✅ | 1/3 | MODEL_FAULT | tests |
| 002-queries/016-pagination_index | ✅ | ❌ | ✅ | 1/3 | MODEL_FAULT | tests |

---

## Per-Failure Analysis

### 1. 000-fundamentals/009-returns_validator (3/3) - KNOWN_GAP

- **Failed step:** deploy (TypeScript typecheck)
- **Error:** `success: boolean` is not assignable to `success: false` in discriminated union
- **Reasoning:** The model returns `{ success: false, error: "..." }` without `as const`, so TypeScript infers `success: boolean` instead of the literal `false` required by the validator. This is documented in GAPS.txt for this eval and affects all models.
- **Model output:** `return { success: false, error: "Post not found" };`
- **Expected:** `return { success: false, error: "Post not found" } as const;`

### 2. 002-queries/018-pagination_returns_validator (3/3) - KNOWN_GAP

- **Failed step:** tests (33%)
- **Error:** `ReturnsValidationError: Object contains extra field 'pageStatus' that is not in the validator`
- **Reasoning:** Convex's `db.paginate()` returns `pageStatus` and `splitCursor` which the model omits from its returns validator. Documented in GAPS.txt.

### 3. 004-actions/007-http_action_routing (3/3) - MODEL_FAULT

- **Failed step:** tests (0% - all 7 tests fail)
- **Error:** `Could not find public function for 'http:getSiteURL'`
- **Reasoning:** The task clearly requires a `getSiteURL` query returning `process.env.CONVEX_SITE_URL!` so the test harness can discover the HTTP base URL. The model implements all the HTTP routes but consistently omits this required helper query. All tests fail because the harness cannot bootstrap.
- **Model output:** HTTP routes only, no `getSiteURL` export
- **Expected:**
  ```ts
  export const getSiteURL = query({
    args: {},
    handler: async (_ctx) => process.env.CONVEX_SITE_URL!,
  });
  ```

### 4. 006-clients/001-use_mutation (3/3) - MODEL_FAULT

- **Failed step:** eslint (`no-undef`)
- **Error:** `'React' is not defined` at the `React.FormEvent` type annotation
- **Reasoning:** The model uses named-only React imports (`import { useState } from "react"`) but then references `React.FormEvent` as a type. With the `react-jsx` transform, JSX doesn't require React, but the `React.` namespace still does. The fix is to import React or use `FormEvent` directly.
- **Model output:** `import { useState } from "react"; ... (e: React.FormEvent)`
- **Fix:** `import React, { useState } from "react"` or `import { useState, type FormEvent } from "react"`

### 5. 003-mutations/006-no_storage (2/3) - MODEL_FAULT

- **Failed step:** deploy (TypeScript typecheck)
- **Error:** `Property 'index' does not exist on type '{}'` - `internal.index` is empty
- **Reasoning:** The model marks `storeFileMetadata` as a public `mutation` instead of `internalMutation`. Since it's called via `ctx.runMutation(internal.index.storeFileMetadata, ...)` from an action, it must be internal. The typecheck catches the mismatch.
- **Model output:** `export const storeFileMetadata = mutation({...})`
- **Expected:** `export const storeFileMetadata = internalMutation({...})`

### 6. 005-idioms/002-batch_queries (2/3) - MODEL_FAULT

- **Failed step:** tests (80% - schema comparison fails)
- **Error:** Schema mismatch: model used index name `by_userId` instead of `by_user`
- **Reasoning:** The task specifies exactly "an index on posts `by_user`". The model used `by_userId` (following the field name convention rather than the literal task requirement). Schema comparison is strict.

### 7. 004-actions/005-storage_http_action (1/3) - MODEL_FAULT

- **Failed step:** tests (83%)
- **Error:** "handles empty request body" test expected 200, got 400
- **Reasoning:** The model added extra validation that rejects empty request bodies with a 400, but the grader explicitly tests that empty bodies return 200 and are stored normally. The model's defensive coding conflicts with the task.

### 8. 002-queries/016-pagination_index (1/3) - MODEL_FAULT

- **Failed step:** tests (schema comparison)
- **Error:** `channelId: v.id("channels")` vs expected `channelId: v.string()`
- **Reasoning:** The task provides an exact schema. The model "improved" `channelId` from `v.string()` to `v.id("channels")`, which is semantically reasonable but violates the strict schema match required.

---

## No-Guidelines Comparison

| Eval | with_gl (3 runs) | no_gl (3 runs) | Change |
|---|---|---|---|
| 000-fundamentals/005-function_calling | ✅✅✅ | ❌❌❌ | Guidelines fix |
| 004-actions/006-node | ✅✅✅ | ❌❌❌ | Guidelines fix |
| 004-actions/007-http_action_routing | ❌❌❌ | ❌❌✅ | Still mostly fails |
| 006-clients/001-use_mutation | ❌❌❌ | ❌❌❌ | Fails both |
| 009-returns_validator | ❌❌❌ | ❌❌❌ | KNOWN_GAP, fails both |
| 018-pagination_returns_validator | ❌❌❌ | ❌❌❌ | KNOWN_GAP, fails both |
| 001-data_modeling/001-compound_datatypes | ✅✅✅ | ❌❌✅ | Mostly fixed by guidelines |
| 003-mutations/005-cascade_delete_nested | ✅✅✅ | ✅❌✅ | Mostly fixed |
| 006-clients/002-use_paginated_query | ✅✅✅ | ✅❌✅ | Mostly fixed |

**Notable:** Guidelines strongly help with `005-function_calling` and `004-actions/006-node` (0% fail with guidelines, 100% fail without). The `001-use_mutation` React import issue and the two KNOWN_GAP evals are unaffected by guidelines.

---

## Cross-Cutting Patterns

1. **Schema fidelity**: Two failures (016-pagination_index, 002-batch_queries) from the model "improving" on schema details given in the task (type upgrade, index naming). The model tends to apply its own conventions rather than copying exactly.

2. **Convex internal functions**: `internalMutation` vs `mutation` is a recurring gap. The model defaults to public mutations even when the usage context (being called from an action via `internal.*`) requires them to be internal.

3. **`getSiteURL` helper**: Consistently forgotten in `007-http_action_routing`. The model implements the main HTTP routes correctly but skips the test scaffolding helper. Worth checking whether the task description emphasis is sufficient.

4. **React namespace imports**: Basic but persistent. The model uses `React.FormEvent` with only named imports. Low priority but very fixable.

5. **Guidelines impact is strong for Node/function-calling evals**: The 2pp gap between experiments is driven by the model needing guidance to use Node actions and correct function-calling patterns.

---

## Recommendations

### No action needed
- `009-returns_validator` - KNOWN_GAP, documented, affects all models
- `018-pagination_returns_validator` - KNOWN_GAP, documented, affects all models

### Possible eval improvements
- **`007-http_action_routing`**: Consider bolding or moving the `getSiteURL` requirement earlier in the task description. The model implements routes correctly every time but skips the helper. Alternatively, check if other models also miss this - if it's model-specific it may just be a model gap.
- **`005-idioms/002-batch_queries`**: The index name `by_user` vs `by_userId` distinction could be made more explicit in the task ("use exact index name `by_user`").

### Model-specific notes
- Gemini 3 Flash responds well to guidelines (5-function_calling and 006-node are fixed)
- The React namespace import issue (`React.FormEvent`) is a consistent pattern to watch in future runs
- `internalMutation` vs `mutation` is a recurring Convex knowledge gap - already covered in guidelines but not fully absorbed

### Net impact assessment
- 2/8 unique failures are KNOWN_GAP (no action possible)
- 6/8 are genuine model faults
- Of the model faults, only `007-http_action_routing` (task clarity) has potential eval-side improvements
- No lint config changes recommended

## Actions taken

None - all actionable failures were determined to be genuine model knowledge gaps (Convex-specific patterns covered in guidelines). The philosophy is that tasks should test whether the model knows Convex, not whether it can follow detailed instructions; spelling out `internalMutation` or where to export `getSiteURL` would undermine what the eval is measuring.
